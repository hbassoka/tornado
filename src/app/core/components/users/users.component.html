<div class="row">
  <!-- HERO -->
  <section class="w-full bg-gray-700 text-white py-6 px-6">
    <div class="container mx-auto text-center">
      <h2 class="text-4xl font-bold mb-2"><i class="bi bi-people  me-2"></i>Gestion des utilisateurs</h2>
      <p class="text-md text-gray-300">
        Gestion et administration des utilisateurs
      </p>
    </div>
  </section>
  <!-- Section Sécurité -->
  <section class="w-full py-12 px-6 bg-white">
    <!-- Header -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-3">
      <h2 class="display-12 mb-2">Liste des utilisateurs</h2>
    </div>
    <div class="row">
      <div class="col-md-6 mb-3">
        <input type="text" class="form-control w-50" placeholder="Rechercher..." [(ngModel)]="search"
          (keyup)="onSearchChange()">
      </div>
      <div class="col-md-6 mb-3 text-end">
        <a class="btn btn-primary" [routerLink]="['edit','']">
          <i class="bi bi-person-plus me-1"></i> Ajouter un utilisateur
        </a>
      </div>
    </div>
    <!-- Users Table -->
    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover  align-middle">
        <thead class="table-primary">
          <tr>
            <th  (click)="sort('id')" style="cursor:pointer;width:5%">
              Id <i *ngIf="sortBy === 'id'" class="bi"
                [ngClass]="{ 'bi-caret-up-fill': direction === 'asc','bi-caret-down-fill': direction === 'desc'}"></i>
            </th>
            <th (click)="sort('username')" style="cursor:pointer">
              Identifiant <i *ngIf="sortBy === 'username'" class="bi"
                [ngClass]="{ 'bi-caret-up-fill': direction === 'asc','bi-caret-down-fill': direction === 'desc'}"></i>
            </th>            
            <th (click)="sort('group')" style="cursor:pointer">
              Groupes <i *ngIf="sortBy === 'group'" class="bi"
                [ngClass]="{ 'bi-caret-up-fill': direction === 'asc','bi-caret-down-fill': direction === 'desc'}"></i>
            </th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of userAvailables">
            <td>{{user.id}}</td>
            <td>{{user.username}}</td>            
            <td>
              <ng-container *ngFor="let group of user.groups">
                {{ group.label}}
              </ng-container>
            </td>
            <td class="text-center">
               <a class="btn btn-sm btn-outline-primary me-2" [routerLink]="['view',user.id]">
                <i class="bi bi-eye fs-6"></i>
              </a>
              <a class="btn btn-sm btn-outline-primary me-2" [routerLink]="['edit',user.id]">
                <i class="bi bi-pencil-square fs-6"></i>
              </a>
              @if(user.deletable) {
                <button   class="btn btn-sm btn-outline-danger" (click)="delete(user.id)">
                  <i class="bi bi-trash fs-6"></i>
               </button>
              }
             
            </td>
          </tr>
        </tbody>
      </table>
      <!-- PAGINATION -->
      <nav class="d-flex justify-content-center">
        <ul class="pagination">

          <!-- previous -->
          <li class="page-item" [class.disabled]="page === 0">
            <button class="page-link" (click)="changePage(page - 1)">Précédent</button>
          </li>

          <!-- pages -->
          <li class="page-item" *ngFor="let p of [].constructor(totalPages); let i = index" [class.active]="i === page">
            <button class="page-link" (click)="changePage(i)">{{i + 1}}</button>
          </li>

          <!-- next -->
          <li class="page-item" [class.disabled]="page === totalPages - 1">
            <button class="page-link" (click)="changePage(page + 1)">Suivant</button>
          </li>
        </ul>
      </nav>
    </div>
    
  </section>

</div>